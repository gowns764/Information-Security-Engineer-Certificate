# 틀리는 것 정리

## 1. 시스템 보안

### 1.1. 트로이목마
- 트로이목마는 자기 복제를 하지 않으며, 다른 파일을 감염시키거나 변경시키지 않는다.
- 일반적인 기능으로는 원격 조정, 패스워드 가로채기, 키보드 입력 가로채기, 시스템 파일 파괴가 있다.

### 1.2. 윈도우 파일 시스템
- **FAT16**
   - 2GB까지를 한 파티션으로 설정할 수 있다.
- **FAT32**
   - 2GB 이상을 한 파티션으로 설정할 수 있다.
   - 호환성이 좋다.
   - 접근제어를 설정할 수 없다.
- **NTFS**
   - 접근제어가 적용되었다.
   - 호환성이 비교적 낮다.

### 1.3. 윈도우 인증의 구성요소
- **LSA** (Local Security Authority)
   - 모든 계정의 로그인에 대한 검증을 한다.
   - 시스템 자원 및 파일 등에 대한 접근 권한을 검사한다.
   - 이름과 SID를 매칭하며, SRM이 생성한 감사 로그를 기록한다.
- **SAM** (Security Account Manager)
   - 사용자/그룹 계정 정보에 대한 데이터베이스를 관리한다.
   - 사용자의 로그인 입력 정보와 SAM 데이터베이스를 비교해 인증 여부를 결정한다.
   - 해시된 비밀번호는 한 번 더 암호화되어 저장된다.
- **SRM** (Security Reference Monitor)
   - 사용자에게 SID를 부여한다.
   - SID에 기반하여 파일이나 디렉터리에 대한 접근을 허용할지를 결정하고, 이에 대한 감사 메시지를 생성한다.

### 1.4. 레지스트리 루트키
- **HKEY_CLASSES_ROOT**
   - 시스템에 등록된 파일 확장자와 그것을 열 때 사용할 애플리케이션에 대한 맵핑 정보 그리고 COM 오브젝트 등록 정보를 저장하고 있다.
- **HKEY_CURRENT_USER**
   - 현재 시스템에 로그인하고 있는 사용자와 관련된 시스템 정보를 저장하고 있다.
- **HKEY_LOCAL_MACHINE**
   - 컴퓨터에 설치된 하드웨어와 하드웨어를 구동시키는 데 필요한 드라이버나 설정 사항에 관련된 정보를 갖고 있다.
   1. **HKEY_USER**
      - 시스템에 있는 모든 계정과 그룹에 관한 정보를 저장하고 있다.
   2. **HKEY_CURRENT_CONFIG**
      - 시스템이 시작할 때 사용하는 하드웨어 프로파일 정보를 저장하고 있다.

### 1.5. UNIX 디렉터리 구조
- **/**
   - root 디렉터리 혹은 최상위 디렉터리이다.
- **/etc**
   - 시스템의 환경 설정 및 주요 설정 파일을 담고 있다.
- **/dev**
   - 물리적인 장치를 다루기 위한 특수 파일을 담고 있다.
- **/usr/bin**
   - 기본적으로 실행 가능한 파일을 담고 있다.
- **/usr/include**
   - C언어 라이브러리 헤더 파일이 저장되는 디렉터리이다.
- **usr/lib**
   - 기본 프로그램의 모듈을 담고 있다.
- **usr/sbin**
   - 시스템 관리 명령어가 저장되는 디렉터리이다.
- **/home**
   - 사용자 홈 디렉터리가 저장되는 디렉터리이다.
- **/tmp**
   - 프로그램 실행 및 설치 시 생성되는 임시 파일을 담고 있다. 
- **/var**
    - 시스템 로그가 저장되는 디렉터리이다.

### 1.6 i-node
- 유닉스에서 각 파일에 대한 정보를 기억하는 고정된 크기의 구조체이다.
- 속성
  - **i-node number**
  - **파일 타입**
  - **접근 권한**
  - **link count**
  - **소유자**
  - **소유 그룹**
  - **파일 크기**
  - **MAC Time**
    - 파일을 마지막으로 수정한 시간
    - 파일을 마지막으로 접근한 시간
    - 파일의 속성을 마지막으로 변경한 시간
  - **Block index**

### 1.7. UNIX 접근 권한
1. **user**
   - 파일을 만든 소유주
2. **group**
   - 파일을 만든 소유주가 속한 그룹의 사용자
3. **other**
   - 기타 사용자

### 1.8 UNIX 접근 권한 변경
- 대상
  - u(user), g(group), o(other), a(all)
- 연산자
  - +(추가), -(제거), =(지정)
- 접근 권한
  - r(읽기), w(쓰기), x(실행)

### 1.9. UNIX 런 레벨
- **0**
  - PROM 모드
- **S, s**
  - 시스템 싱글 유저 모드
  - 로컬 파일시스템이 마운트 되지 않은 상태
- **1**
  - 시스템 싱글 유저 모드
  - 로컬 퍼일시스템이 마운트 된 상태
- **2**
  - 멀티 유저 모드
  - NFS 클라이언트 모드
- **3**
  - 멀티 유저 모드
  - NFS 서버 모드
  - UNIX 기본 런 레벨
- **4**
  - 사용 안함
- **5**
  - 시스템 power off 모드
- **6**
  - 시스템 리부팅

### 1.10. TCPWrapper의 기능
- IP 주소에 대한 접근통제
- 로깅
- 네트워크 서비스에 대한 접근통제

### 1.11. PAM
- **PAM**은 리눅스 배포판에서 사용자 인증의 핵심이며, 각 애플리케이션에 대한 인증 형태, 사용자 권한, 접근 자원 등을 선택할 수 있는 라이브러리이다.
- PAM을 사용한 인증 절차
  1. 사용자나 프로세스가 애플리케이션의 접근을 요청한다.
  2. 해당 애플리케이션의 PAM 설정 파일을 확인한다.
  3. 스택의 PAM모듈이 리스트상의 순서대로 호출된다.
  4. PAM모듈은 성공 또는 실패 상태를 반환한다.
  5. 스택은 계속해서 순서대로 확인되며, 실패 상태를 반환한다해서 중단되지 않는다.
  6. 모든 PAM모듈의 상태 결과가 종합되어 전체 인증 과정의 성공 또는 실패 상태를 반환한다.

### 1.12. 유닉스/리눅스 시스템의 로그
- **wtmp**
  - 사용자 로그인, 로그아웃 정보
- **utmp**
  - 현재 로그인한 사용자 정보
- **btmp**
  - 로그인 실패 정보
- **pacct**
  - 사용자가 로그인한 후부터 로그아웃할 때까지 입력한 명령과 시간에 대한 정보
- **history**
  - 사용자별로 실행한 명령을 기록
- **lastlog**
  - 각 사용자의 최근 로그인 시각과 접근한 소스 호스트에 대한 정보
- **sulog**
  - su 명령어를 사용한 경우, 변경 전 사용자 계정과 변경 후 사용자 계정 및 시간 정보
- **dmesg**
  - 부팅될 때 출력되는 모든 메시지를 기록
- **cron**
  - 시스템의 정기적인 작업에 대한 정보
- **messages**
  - 시스템 운영에 대한 전반적인 메지시를 저장
- **secure**
  - 원격로그인 정보

### 1.13. 취약점 분석 도구
- **SATAN**
  - 해커와 같은 방식으로 시스템에 침입하여 보안상의 약점을 찾아 보완할 수 있다.
  - 해커에게 노출될 수 있는 약점을 사전에 발견한다.
- **SARA**
  - SATAN이 업데이트가 되지 않는 상황에서 SATAN을 기반으로 개발된 취약점 분석도구이다.
- **SAINT**
  - 유닉스 플랫폼에서 동작하는 네트워크 취약점 분석도구이다.
  - 원격에서 취약점을 점검하는 기능이 있다.
- **COPS**
  - 유닉스 플랫폼에서 동작하며 시스템 내부에 존재하는 취약점을 점검하는 도구이다.
  - 취약한 패스워드를 체크한다.
- **Nessus**
  - 클라이언트-서버 구조로 클라이언트의 취약점을 점검하는 기능이 있다.
  - 사용이 자유롭고 플러그인 업데이트 등이 쉽다.
  - 여러 형태로 결과를 리포트 해준다.
- **nmap**
  - 포트스캐닝 도구로 TCP connect 방식뿐만 아니라, stealth 모드로 포트 스캐닝하는 기능을 포함한다.

### 1.14. 프로세스 메모리 구조
- **Text 영역**
  - 프로그램 코드와 상수가 정의되어 있고, 읽기만 가능한 영역이다.
- **Data 영역**
  - 전역변수와 정적변수가 저장되어 있는 영역이다.
- **Heap 영역**
  - 필요에 따라 동적 메모리 호출에 의해 할당되는 영역이다.
- **Stack 영역**
  - 함수의 인자 값, 함수 내의 지역변수, 함수의 반환 주소 등이 저장되는 영역이다.
  - 상위 메모리 주소에서 하위 메모리 주소로 데이터기 저장된다.

### 1.15. 스택 버퍼 오버플로우
- SetUID가 설정된 루트 권한의 프로그램을 공격 대상으로 한다.
- 스택에 정해진 버퍼보다 큰 공격 코드를 상입하여 반환 주소를 변경함으로써, 임의의 공격 코드를 루트 권한으로 실행하도록 하는 방법이다.

### 1.16. 버퍼 오버플로우 공격 대응책
1. **컴파일 시간 방어**
   - 새 프로그램 내에서 공격을 저지하도록 프로그램을 강화하는 것을 목표로 한다.
   1. 사용을 자제해야 하는 함수
      - strcat(), srtcpy(), gets(), scanf(), sscanf(), vscanf(), vsscanf(), sprintf(), vsprintf(), gethostbyname(), realpath()
   2. 사용을 권장하는 함수
      - strncat(), strncpy(), fgets(), fscanf(), vfscanf(), snprintf(), vsnprintf()
2. **실행 시간 방어**
   - 존재하는 프로그램에서 공격을 발견하고 중지시키는 것을 목표로 한다.

### 1.17. 포맷 스트링 공격
- 포맷 스트링을 사용하는 함수를 사용하는 경우, 외부로부터 입력된 값을 검증하지 않고 입출력 함수의 포맷 문자열 그대로 사용하는 경우 발생할 수 있는 취약점이다.
- 공격자는 포맷 스트링을 이용하여 취약한 프로세스를 공격하거나 메모리 내용을 읽거나 쓸 수 있으며, 버퍼 오버플로우를 통해 임의의 코드를 실행하거나 데이터 표현에 관한 문제를 일으킬 수가 있다.
- 포맷 스트링 취약점의 위협 요소
  1. **프로그램의 파괴**
     - 프로세스를 죽게 만든다.
  2. **프로세스 메모리 보기**
     - 포맷 함수의 응답을 볼 수 있다면 그것으로부터 유용한 정보를 수집할 수 있으며, 공격자는 이 결과를 통해 포맷 스트링이 무엇을 하며, 프로세스 배치가 어떻게 생겼는지에 대한 개략적인 내용을 획득하는 데 사용할 수 있다.
  3. **임의의 메모리 덮어쓰기**
     - 공격은 어떤 프로세스의 명령 통제권을 장악할 수 있다.

### 1.18. 레이스 컨디션 공격
- 둘 이상의 프로세스나 스레드가 공유 자원에 동시에 접근할 때 접근하는 순서에 따라 비정상적인 결과가 발생하는 조건/상황을 말한다.
- 실행되는 프로세스가 임시파일을 만드는 경유, 악의적인 프로그램을 통해 그 프로세스의 실행 중에 끼어들어 임시파일을 목적파일로 연결하여 악의적인 행위를 한다.