# 틀리는 것 정리

## 2. 네트워크 보안

### 2.1. DoS
- 공격자가 단일 컨퓨터를 통해 공격한다.

#### 2.1.1. TCP SYN Flooding Attack
- TCP 연결 설정 과정 중에 3-Way Handshaking 과정에서 Half-Open 연결 시도가 가능하다는 취약점을 이용한 공격이다.
- 공격 대상 시스템은 외부로부처 접속 요청을 더 이상 받아드릴 수 없게 되어 정상적인 서비스를 제공할 수 없게 된다.
- 공격자가 다수의 syn 신호를 공격 대상자에게 전송하면 공격 대상자는 syn/ack 신호를 공격자에게 전달하게 되는데, 이 때 공격자가 ack 신호를 반송하지 않으면 공격 대상자의 시스템은 일정 시간 동안 신호를 기다리게 된다.

#### 2.1.2. SMURF Attack
- IP 위장과 ICMP의 특징을 이용한 공격이다.
- 공격 방법
    1. 공격자는 IP를 공격 대상 서버의 IP 주소로 위장하여, ICMP를 브로드캐스트로 다수의 시스템에 전송한다.
    2. 이 때 ICMP 브로드캐스트를 수신한 다수의 시스템은 ICMP Echo 패킷을 공격자가 아닌, 공격 대상 서버로 전송하게 된다.
    3. 결과적으로 공격 대상 서버는 다수의 ICMP Echo를 수신하게 되어 시스템 성능에 문제를 일으키게 된다.
    4. 이 때 다수의 시스템은 브로드캐스트에 대한 응답으로 다수의 ICMP Echo 패킷을 발생시키기 때문에 증폭 네트워크라고 불리게 된다.
- 보안 대책
  - 라우터에서 다른 네트워크로부터 자신의 네트워크로 들어오는 IP directed broadcast 패킷을 막도록 설정한다.
  - 호스트는 IP broadcast address로 전송된 ICMP 패킷에 대해 응잡하지 않도록 시스템을 설정한다.
  - 동일한 ICMP Echo Reply 패킷이 다량으로 발생하면, 해당 패킷들을 침입차단시스템을 통해 모두 차단시킨다.

#### 2.1.3. Land Attack
- 패킷을 전송할 때 출발지 IP 주소와 목적지 IP 주소 값을 똑같이 만들어서 공격 대상에 보내는 것이다.
- 이 때 조작된 IP 주소 값은 공격 대상의 IP 주소이다.

#### 2.1.4. Ping of Death
- Ping을 이용하여 ICMP 패킷을 정상 크기보다 아주 크게 만드는 것이다.
- 크게 만들어진 패킷은 네트워크를 통해 라우팅되어 공격 네트워크에 도달하는 동안 아주 작은 조작으로 쪼개지고, 공격 대상은 조각화된 패킷을 모두 처리해야 하므로 정상적인 ping 처리보다 부하가 훨씬 많이 걸린다.

#### 2.1.5. Teardrop Attack
- 네트워크상에서 IP가 정상적으로 패킷을 전송할 때, IP 단편화가 발생하게 된다.
  - 수신자는 재조립을 통해 단편화된 데이터를 복구한다.
- 이 때 재조립 시에 정확한 조립을 위해 오프셋 값을 더하게 되어 있는데, 이 오프셋 값을 단편화 간에 중복되도록 고의적으로 수정하거나 정상적인 오프셋 값보다 더 큰 값을 더해 그 범위를 넘어서는 오버플로우를 일으켜 시스템을 마비시킨다.
- 공격당한 시스템은 네트워크 연결이 끊어지거나 블루스크린이 표시된다.

### 2.2. DDoS
- 공격자가 물리적으로 분산된 다수의 컴퓨터를 이용하여 공격한다.

#### 2.2.1. 공격 대응 절차
1. 공격의 인지
2. DDoS 공격 유형 파악
3. 공격 유형에 따른 차단 정책 정의 및 대응
4. 공격 대응 후, 사후 조치

### 2.3. DRDoS
- 별도의 에이전트 설치 없이 프로토콜 구조의 취약점을 이용하여 정상적인 서비스를 운영하는 시스템을 분산 반사 서비스 거부 공격의 에이전트로 활용하여 공격한다.

### 2.4. 포트 스캔 공격 종류

#### 2.4.1. Open 스캔
- 시스템 자체의 활성화 여부뿐만 아니라, 스캔하는 포트에 해당되는 서비스의 활성화 여부를 조사할 수 있는 방법이다.
- 포트를 스캔하여 포트가 열려있다면 해당 시스템이 활성되되어 있는 것으로 판단할 수 있을 뿐만 아니라 해당 포트가 제공하는 서비스를 예측할 수 있다.

##### 2.4.1.1. TCP 스캔
- 연결을 완료하느냐, 완료하지 않느냐에 따라 TCP Full Open 스캔과 TCP Half Open 스캔이 있다.
- **TCP Full Opne 스캔** (TCP Connect 스캔)
  - 포트가 열려 있는 경우
    - 대상 시스템으로부터 SYN/ACK 패킷을 수신하면 그에 대한 ACK 패킷을 전송함으로써 연결을 완료한다.
  - 포트가 닫혀 있는 경우
    - 대상 시스템이 연결 요청을 받아들이지 못하므로 RST/ACK 패킷을 전송한다.
- **TCP Half Open 스캔** (TCP SYN 스캔)
  - 로그를 남기지 않아 추적이 불가능하도록하는 기법이다.
  - 세션을 완전히 연결하지 않고, TCP Half Connection만으로 포트의 활성화 여부를 판단한다.
  - 포트가 열려 있는 경우
    - 공격자가 STN 패킷을 공격 대상 서버에 보낸 후 포트가 열려 있는 서버로부터 SYN/ACK 패킷을 받으면, 공격자는 즉시 RST 패킷을 보내 연결을 끊음으로써 연결 시도 세션에 대한 로그를 남기지 않도록 한다.
    - 공격자의 STN 세그먼트 전송 기록은 남게 되므로 스캐닝 공격 사실을 완전히 숨길 수는 없다.
  - 포트가 닫혀 있는 경우
    - 대상 시스템이 연결 요청을 받아들이지 못하므로 RST/ACK 패킷을 전송한다.

##### 2.4.1.3. UDP 스캔
- ICMP Port Unreachable 에러 메시지를 통해 포트의 활성화 유무를 확인할 수 있다.
- 포트가 열려 있는 경우
  - 아무런 응답이 없다.
- 포트가 닫혀 있는 경우
  - ICMP Port Unreachable 에러 메시지가 수신된다.

#### 2.4.2. Stealth 스캔
- TCP 헤더를 조작하여 특수한 패킷을 만든 후, 스캔 대상 시스템에 보내 그 응답으로 포트 활성화 여부를 알아내는 기법이다.
- 포트가 열려 있는 경우
  - 아무런 응답이 없다.
- 포트가 닫혀 있는 경우
  - 대상 시스템이 RTS 패킷을 전송한다.
- 종류
  - **FIN 스캔**
    - TCP의 FIN 플래그를 ON으로 설정하여 패킷을 전송한다.
  - **NULL 스캔**
    - TCP의 모든 플래그를 OFF로 설정하여 패킷을 전송한다.
  - **XMAS 스캔**
    - TCP의 모든 플래그를 ON으로 설정하여 패킷울 전송한다.

##### 2.4.2.1. TCP ACK 스캔
- 방화벽의 필터링 정책을 테스트하기 위한 스캔이다.
- TCP ACK 플래그를 ON으로 설정하여 패킷을 전송한다.
- 필터링이 되는 경우
  - 아무런 응답이 없다.
- 필터링이 되지 않는 경우
  - 대상 시스템이 RST+ACK 패킷을 전송한다.

### 2.5. 스위칭 환경에서의 스니핑
- **스위치 재밍**
  - 스위치의 MAC Address Table 버퍼를 오버플로우시켜서 스위치가 허브처럼 동작하게 강제적으로 만드는 기법이다.
- **ARP 스푸핑**
  - 공격자가 특정 호스트의 MAC 주소를 자신의 MAC 주소로 위조한 ARP Reply 패킷을 만들어 희생자에게 지속적으로 전송하면, 희생자의 ARP Cache에 특정 호스트의 MAC 정보가 공격자의 MAC 정보로 변경된다.
- **ARP 리다이렉트**
  - 공격자가 자신이 라우터인 것처럼 MAC 주소를 위조하여, ARP Reply 패킷을 해당 네트워크에 브로드캐스트한다.
- **ICMP 리다이렉트**
  - 3계층에서 스니핑 시스템을 네트워크에 존재하는 또 다른 라우터라고 알림으로써 패킷의 흐름을 바꾸는 공격이다.

### 2.6. 스푸핑
- **ARP 스푸핑**
  - 호스트의 주소 매칭 테이블에 위조된 MAC 주소가 설정되도록 하는 공격이다.
- **IP 스푸핑**
  - 공격자가 자신의 IP 주소가 아닌 신뢰 관계를 가진 시스템의 주소로 위장하여 공격 대상 서버로부터 정보를 가로채는 공격이다.

### 2.7. 침입탐지시스템 (IDS)
- 실행 단계
  1. 데이터 수집
  2. 데이터 가공 및 축약
  3. 침입 분석 및 탐지
  4. 보고 및 대응
- 종류
  1. 탐지 방법에 의한 분류
     - **규칙 기반 침입 탐지** (오용 침입 탐지)
     - 시스템 로그, 네트워크 입력 정보, 알려진 침입 방법, 비정상적인 행위 패턴 등의 특징을 비교하여 탐지하는 방법이다.
     - 즉, 기존의 침입 방법을 데이터베이스에 저장해 두었다가 사용자 행동 패턴이 기존의 침입 패턴과 일치하거나 유사한 경우에 침입이라 판단한다.
     - 종류
       - **전문가 시스템**, **상태전이 모델**, **패턴 매칭**
     - **통계적 변형 탐지** (비정상 침입 탐지)
       - 관찰된 사건들을 정상적인 행위에 대한 정의들과 비교하여 심각한 수준의 일탈 행위를 식별하는 방법이다.
       - 오용 탐지 방법보다 데이터베이스 관리과 용이하고 제로데이 공격도 탐지가 가능하며, 침입 이외의 시스템 운용상의 문제점도 발견할 수 있다.
       - 반면, 실시간 탐지가 어렵다.
       - 종류
         - **통계적 분석 방법**, **예측 가능한 패턴 생성 방법**, **신경망 모델**
  2. 데이터 수집원에 의한 분류
     - **네트워크 기반 IDS**
       - 네트워크에서의 패킷 헤더, 데이터 및 트래픽 양, 응용프로그램 로그 등을 분석하여 침입 여부를 판단한다.
       - 즉, 네트워크를 통해 전송되는 패킷의 정보를 수집 분석하여 침입을 탐지하는 시스템이다.
     - **호스트 기반 IDS**
       - 호스트 시스템으로부터 생성되고 수집된 감사 자료를 침입 탐지에 사용하는 시스템이다.
       - 네트워크 기반 IDS가 탐지할 수 없는 침입을 탐지하며, 시스템 이벤트 감시를 통한 정확한 침입 탐지가 가능하다.
- **Snort**
  - 일종의 IDS로 실시간 분석, 프로토콜 분석, 내용 검색/매칭, 침입 탐지 Rule에 의거하여 다양한 공격과 스캔을 탐지한다.

### 2.8. 침입방지시스템 (IPS)
- 방화벽, IDS, IPS 비교
  - |구분|방화벽|IDS|IPS|
    |:-:|:-:|:-:|:-:|
    |목적|접근 통제 및 인가|침입 여부 감지|침입 이전의 방지|
    |특징|수동적 차단<br>내부망 보호|로그, 시그니처 기반의 패턴 매칭|정책 규칙 DB 기반의 비정상 행위 탐지|
    |패킷 차단|O|X|O|
    |패킷 내용 분석|X|O|O|
    |오용 탐지|X|O|O|
    |오용 차단|X|X|O|
    |이상 탐지|X|O|O|
    |이상 차단|X|X|O|
    |장점|엄격한 접근 통제<br>인가된 트래픽 허용|실시간 탐지<br>사후 분석 대응 기술|실시간 즉각 대응<br>세션 기반 탐지 기능|
    |단점|내부자 공격 취약<br>네트워크 병목 현상|변형된 패턴에 대해서는 탐지 어려움|오탐 현상 발생 가능<br>장비 고가|

### 2.9. VPN의 구성
1. **터널링**
   - 송신자와 수신자 사이의 전송로에 외부로부터의 침입을 막기 위해 일종의 파이프를 구성하는 것이다.
   - 파이프는 터널링을 제원하는 프로콜을 사용하여 구현하고 있으며, 사설망과 같은 보안 기능을 지원한다.
   - 터너링되는 데이터를 **ㅠㅔ이로드**라고 부르며, 터널링 구간에서 페이로드는 그저 전송되는 데이터로 취급되어 그 내용은 변경되지 않는다.
2. 2계층 터널링 프로토콜
   - **PPTP** (Point-to-Point Tunneling Protocol)
     - 페이로드를 암호화하고, IP 헤더로 캡슐화하여 전송한다.
     - 터널의 유지·보수·관리를 위하여 TCP 연결을 사용하고, 이동통신사용자가 서버에 접속하기에 용이하게 구성되어 있다.
   - **L2F**
     - NAS 개시 VPN형이기 때문에 사용자는 별도의 S/W가 필요 없다.
     - 하나의 터널에 여러 개의 연결을 지원하여 다자간 통신이 가능하다.
     - UDP를 사용한다.
   - **L2TP**
     - PPTP와 L2F를 결합한 방법으로, 마이크로소프트와 시스코에서 지원하고 있으며, 호환성이 뛰어나다.
3. 3계층 터널링 프로토콜
   - **IPSec**
     - IP망에서 안전하게 정보를 전송하는 표준화된 3계층 터널링 프로토콜이다.
     - AH와 ESP를 통해 IP 데이터그램의 인증과 무경설, 기밀성을 제공한다.

### 2.10. NAC (Network Access Control)
- 정의
  - 네트워크에 접근하는 접속 단말의 보안성을 검증하여 보안성을 강제화하고 접속을 통제할 수 있는 보안 인프라이다.
  - 사용 단말이 내부 네트워크에 접근하기 전에 보안 정책을 준수했는지 여부를 검사하여 네트워크 접속을 통제하는 보안 솔루션이다.
- 주요 기능
  - 접근 제어/인증
  - PC 및 네트워크 장치 통제 (무결성 체크)
  - 해킹, 웜, 유해 트래픽 탐지 및 차단